---
dist: trusty
sudo: false
language: php
services:
  - mysql
before_script:
  - '! find . -type f -name "*.php" -exec php -d error_reporting=32767 -l {} \; 2>&1 >&- | grep "^"'
  - php -S 0.0.0.0:8000
  - mysql -e 'CREATE DATABASE 2moons;'
php:
  - '7.0'
install:
  - composer install
env:
  - DB_HOST: localhost
  - DB_USER: travis
  - DB_PASSWORD:
  - DB_NAME: 2moons
  - ADMIN_NAME: admin
  - ADMIN_PASSWORD: admin
  - ADMIN_MAIL: mail@example.com

script: phantomjs tests/run.js